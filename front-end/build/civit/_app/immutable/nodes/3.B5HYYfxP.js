import{f as c,a as o,c as U,t as ae}from"../chunks/BS2KmxAA.js";import{p as Oe,f as d,b as He,e as r,N as L,d as e,r as s,g as a,O as ze,s as oe,c as P,M as re,a as ft,o as gt,P as $t}from"../chunks/3Zua7X1K.js";import{A as Je,u as Ue,I as Ne,B as fe,S as xt,b as wt,C as Te,e as bt,s as Ae,a as kt}from"../chunks/d0l0sUZe.js";import{s as u}from"../chunks/BtXMujht.js";import{i as Be}from"../chunks/VK--9A4D.js";import{c as n}from"../chunks/Bc_KlqNo.js";import{D as yt,a as Mt,b as Pt,c as Ct,d as Dt,e as St,t as jt,P as Ie,T as zt,f as Le,g as Nt,h as Tt,i as F,j as se,k as At}from"../chunks/DjVuKG9q.js";const Bt=!1,oa=Object.freeze(Object.defineProperty({__proto__:null,ssr:Bt},Symbol.toStringTag,{value:"Module"}));async function It(v){let f={};if(v.length<1)return{status:400,data:f};let C=0;if(Lt(v))C=parseInt(v);else{const p=v.split("/models/");if(p.length<2)return{status:400,data:f};C=parseInt(p[1].split("/")[0])}try{const p=await fetch(Je.get_model_by_id(Ue.token,C));return p.status!==200?{status:400,data:f}:{status:200,data:await p.json()}}catch{return{status:400,data:{}}}}function Lt(v){return typeof v=="string"&&v.trim()!==""&&!Number.isNaN(Number(v))}var Ot=c("<!> Download",1),Ht=c("<!> <!>",1),Jt=c('<!> <div class="grid gap-4"><!></div> <!>',1),Ut=c("<form><!></form>"),Vt=c("<!> Download model",1),qt=c(`<div class="flex flex-col items-center py-4 gap-6"><h2 class="text-center">You haven't downloaded any models yet.</h2> <div class="actions flex items-center mx-auto"><!></div></div>`),Et=c("<!> Download model",1),Zt=c('<video autoplay style="width: 100%;" class="block rounded-xs" loop preload="auto" disablepictureinpicture=""><source type="video/webm"/></video>',2),Kt=c('<div class="w-full h-full"><h2 class="scroll-m-20 text-2xl font-semibold tracking-tight"> </h2> <h2 class="scroll-m-20 text-xs font-normal tracking-tight pt-2 text-muted-foreground"> </h2> <div class="model-details flex align-middle pt-5 gap-4"><span class="flex items-center gap-2 text-muted-foreground"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-user-icon lucide-user"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg> </span> <span class="flex items-center gap-2 text-muted-foreground"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-layers-icon lucide-layers"><path d="M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z"></path><path d="M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12"></path><path d="M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17"></path></svg> </span> <span class="flex items-center gap-2 text-muted-foreground"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-calendar-icon lucide-calendar"><path d="M8 2v4"></path><path d="M16 2v4"></path><rect width="18" height="18" x="3" y="4" rx="2"></rect><path d="M3 10h18"></path></svg> </span></div> <div class="model-details flex align-middle pt-4 gap-4"><span class="flex items-center gap-2 text-muted-foreground"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-down-to-line-icon lucide-arrow-down-to-line"><path d="M12 17V3"></path><path d="m6 11 6 6 6-6"></path><path d="M19 21H5"></path></svg> </span> <span class="flex items-center gap-2 text-muted-foreground"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-thumbs-up-icon lucide-thumbs-up"><path d="M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z"></path><path d="M7 10v12"></path></svg> </span> <span class="flex items-center gap-2 text-muted-foreground"><svg style="rotate: 180deg;" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-thumbs-up-icon lucide-thumbs-up"><path d="M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z"></path><path d="M7 10v12"></path></svg> </span> <span class="flex items-center gap-2 text-muted-foreground"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-zap-icon lucide-zap"><path d="M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z"></path></svg> </span></div> <div class="model-details flex align-middle pt-8 gap-2 w-full flex-col text-muted-foreground" style="max-width: 400px"><div class="flex items-center"><span> </span> <span class="block ml-auto" style="font-size: .85em"> </span></div> <div class="block w-full"><div data-slot="progress" class="bg-primary/20 relative h-2 overflow-hidden rounded-full w-full" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="66" data-value="66" data-state="loading" data-max="100" data-min="0" data-progress-root=""><div data-slot="progress-indicator" class="bg-primary h-full w-full flex-1 transition-all"></div></div></div></div></div>'),Wt=c("<!> <!> <!> <!> <!>",1),Xt=c("<!> <!>",1),Yt=c('<div class="flex items-center py-4"><div class="mr-12 w-full"><!></div> <div class="actions flex items-center ml-auto"><!></div></div> <!>',1),Ft=c("<!> <!>",1);function Gt(v,f){Oe(f,!0);const C=l=>{var h=U(),m=d(h);n(m,()=>St,(j,V)=>{V(j,{get open(){return a(O)},children:(q,E)=>{var z=Ut(),N=r(z);n(N,()=>yt,(Q,H)=>{H(Q,{children:(R,le)=>{var Z=Jt(),ee=d(Z);n(ee,()=>Mt,(X,g)=>{g(X,{children:(A,B)=>{var t=U(),$=d(t);n($,()=>Pt,(J,_)=>{_(J,{children:(D,x)=>{L();var w=ae("Download a new model");o(D,w)},$$slots:{default:!0}})}),o(A,t)},$$slots:{default:!0}})});var T=e(ee,2),K=r(T);Ne(K,{min:"1",id:"modelParam",type:"text",required:!0,placeholder:"Paste the model id or page url",class:"w-full"}),s(T);var W=e(T,2);n(W,()=>Ct,(X,g)=>{g(X,{children:(A,B)=>{var t=Ht(),$=d(t);{let _=ze(()=>wt({variant:"outline"}));n($,()=>Dt,(D,x)=>{x(D,{get class(){return a(_)},children:(w,Y)=>{L();var b=ae("Cancel");o(w,b)},$$slots:{default:!0}})})}var J=e($,2);fe(J,{type:"submit",get disabled(){return a(G)},onclick:Ve,children:(_,D)=>{var x=Ot(),w=d(x);{var Y=b=>{xt(b,{})};Be(w,b=>{a(G)&&b(Y)})}L(),o(_,x)},$$slots:{default:!0}}),o(A,t)},$$slots:{default:!0}})}),o(R,Z)},$$slots:{default:!0}})}),s(z),o(q,z)},$$slots:{default:!0}})}),o(l,h)},p=l=>{var h=qt(),m=e(r(h),2),j=r(m);fe(j,{onclick:()=>{P(O,!1),P(O,!0)},variant:"outline",children:(V,q)=>{var E=Vt(),z=d(E);Ie(z,{}),L(),o(V,E)},$$slots:{default:!0}}),s(m),s(h),o(l,h)};let S=oe(""),O=oe(!1),G=oe(!1);async function Ve(l){P(G,!0);const h=document.querySelector("#modelParam").value.trim();let m=await It(h);if(P(G,!1),m.status!==200){jt.error("The provided url/id is not valid");return}P(O,!1),window.dispatchEvent(new CustomEvent("DownloadManagerShowModelVersions",{detail:{ModelData:m.data}}))}const qe={year:"numeric",month:"long",day:"numeric"};function Ee(l){return l&&l[0].toUpperCase()+l.substring(1).toLowerCase()}function ge(l){}var $e=Ft(),xe=d($e);C(xe);var Ze=e(xe,2);{var Ke=l=>{p(l)},We=l=>{var h=Yt(),m=d(h),j=r(m),V=r(j);Ne(V,{type:"text",placeholder:"Search by model name",style:"max-width: 400px;",get value(){return a(S)},set value(N){P(S,N,!0)}}),s(j);var q=e(j,2),E=r(q);fe(E,{onclick:()=>{P(O,!1),P(O,!0)},variant:"outline",children:(N,Q)=>{var H=Et(),R=d(H);Ie(R,{}),L(),o(N,H)},$$slots:{default:!0}}),s(q),s(m);var z=e(m,2);n(z,()=>At,(N,Q)=>{Q(N,{children:(H,R)=>{var le=Xt(),Z=d(le);n(Z,()=>zt,(T,K)=>{K(T,{children:(W,X)=>{var g=U(),A=d(g);n(A,()=>Le,(B,t)=>{t(B,{children:($,J)=>{var _=U(),D=d(_);n(D,()=>Nt,(x,w)=>{w(x,{children:(Y,b)=>{Te(Y,{"data-version-id":"headerCheckbox",onclick:ge})},$$slots:{default:!0}})}),o($,_)},$$slots:{default:!0}})}),o(W,g)},$$slots:{default:!0}})});var ee=e(Z,2);n(ee,()=>Tt,(T,K)=>{K(T,{children:(W,X)=>{var g=U(),A=d(g);bt(A,17,()=>f.downloads,B=>B.id,(B,t)=>{var $=U(),J=d($);{let _=ze(()=>a(t).base_model.toLowerCase().includes(a(S).toLowerCase())?"":"position: absolute; scale: 0");n(J,()=>Le,(D,x)=>{x(D,{get style(){return a(_)},children:(w,Y)=>{var b=Wt(),we=d(b);n(we,()=>F,(k,y)=>{y(k,{class:"font-medium",style:"width: min-content;",children:(M,te)=>{Te(M,{get"data-version-id"(){return a(t).id},onclick:ge})},$$slots:{default:!0}})});var be=e(we,2);n(be,()=>F,(k,y)=>{y(k,{class:"font-medium",style:"width: 160px;",children:(M,te)=>{var i=Zt();i.muted=!0;var I=r(i);s(i),re(()=>{Ae(i,"poster",a(t).cover),Ae(I,"src",a(t).cover)}),o(M,i)},$$slots:{default:!0}})});var ke=e(be,2);n(ke,()=>F,(k,y)=>{y(k,{children:(M,te)=>{var i=Kt(),I=r(i),Ye=r(I,!0);s(I);var ne=e(I,2),Fe=r(ne,!0);s(ne);var ie=e(ne,2),de=r(ie),Ge=e(r(de));s(de);var ue=e(de,2),Qe=e(r(ue));s(ue);var Me=e(ue,2),Re=e(r(Me));s(Me),s(ie);var ce=e(ie,2),ve=r(ce),et=e(r(ve));s(ve);var pe=e(ve,2),tt=e(r(pe));s(pe);var he=e(pe,2),at=e(r(he));s(he);var Pe=e(he,2),rt=e(r(Pe));s(Pe),s(ce);var Ce=e(ce,2),me=r(Ce),_e=r(me),st=r(_e,!0);s(_e);var De=e(_e,2),ot=r(De);s(De),s(me);var Se=e(me,2),je=r(Se),lt=r(je);s(je),s(Se),s(Ce),s(i),re((nt,it,dt,ut,ct,vt,pt,ht,mt,_t)=>{u(Ye,a(t).base_model),u(Fe,a(t).file_name),u(Ge,` ${nt??""}`),u(Qe,` ${a(t).based_on_model??""}`),u(Re,` ${it??""}`),u(et,` ${dt??""}`),u(tt,` ${ut??""}`),u(at,` ${ct??""}`),u(rt,` ${vt??""}`),u(st,pt),u(ot,`${ht??""}/s (${mt??""} / ${_t??""})`),kt(lt,`transform: translateX(-${100-a(t).downloaded*100/a(t).total_size}%);`)},[()=>a(t).author_name.replace('"',""),()=>new Date(a(t).published_at).toLocaleDateString("en-UK",qe),()=>JSON.parse(a(t).stats.slice(0,-1)).downloadCount,()=>JSON.parse(a(t).stats.slice(0,-1)).thumbsUpCount,()=>JSON.parse(a(t).stats.slice(0,-1)).thumbsDownCount,()=>JSON.parse(a(t).stats.slice(0,-1)).tippedAmountCount,()=>Ee(a(t).status),()=>se(Math.round(a(t).download_speed)).toString(),()=>se(Math.round(a(t).downloaded)).toString(),()=>se(Math.round(Math.max(a(t).total_size,1))).toString()]),o(M,i)},$$slots:{default:!0}})});var ye=e(ke,2);n(ye,()=>F,(k,y)=>{y(k,{children:(M,te)=>{L();var i=ae();re(()=>u(i,a(t).model_name)),o(M,i)},$$slots:{default:!0}})});var Xe=e(ye,2);n(Xe,()=>F,(k,y)=>{y(k,{children:(M,te)=>{L();var i=ae();re(I=>u(i,I),[()=>se(Math.round(a(t).total_size)).toString()]),o(M,i)},$$slots:{default:!0}})}),o(w,b)},$$slots:{default:!0}})})}o(B,$)}),o(W,g)},$$slots:{default:!0}})}),o(H,le)},$$slots:{default:!0}})}),o(l,h)};Be(Ze,l=>{f.downloads.length<1?l(Ke):l(We,!1)})}o(v,$e),He()}function la(v,f){Oe(f,!0);let C=0,p=oe(ft([]));gt(()=>{C=setInterval(async()=>{const S=await fetch(Je.list_downloads(Ue.token));S.status===200&&P(p,await S.json(),!0)},500)}),$t(()=>{clearInterval(C)}),Gt(v,{get downloads(){return a(p)}}),He()}export{la as component,oa as universal};
